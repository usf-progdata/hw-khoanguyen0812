---
title: "HW2"
author: "Khoa Nguyen"
date: "2/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(gapminder)
library(tidyverse)
library(dplyr)
library(ggplot2)
```

# Excerise 1

## 1.1

Use filter() to subset the gapminder data to three countries of your choice in the 1970’s.


```{r}
filter(gapminder, country %in% c("China", "Japan", "France") & year ==1970:1979)
```

## 1.2

Use the pipe operator %>% to select “country” and “gdpPercap” from your filtered dataset in 1.1.

```{r}
gapminder %>% 
  filter(country %in% c("China", "France", "Japan") & year == 1970:1979) %>% 
  select(country, gdpPercap)
```

## 1.3

Make a new variable in gapminder for the change in life expectancy from the previous measurement. Filter this table to show all of the entries that have experienced a drop in life expectancy.


```{r}
gapminder %>% 
  mutate(dropLifeExp = lag(lifeExp)) %>% 
  filter(dropLifeExp <= lifeExp)
```

## 1.4

Filter gapminder so that it shows the max GDP per capita experienced by each country.


```{r}
gapminder %>% 
  select(country, gdpPercap) %>%
  group_by(country) %>%
  filter(gdpPercap == max(gdpPercap))
```
  
## 1.5

Produce a scatterplot of Canada’s life expectancy vs. GDP per capita using ggplot2, without defining a new variable. That is, after filtering the gapminder data set, pipe it directly into the ggplot() function. In your plot, put GDP per capita on a log scale.


```{r}
gapminder %>% 
  filter(country == "Canada") %>% 
  ggplot() +
  aes(x= lifeExp, y= gdpPercap) +
  geom_point(fill = "red", color = "red", alpha = .5, size = 3) +
  scale_y_continuous(trans = "log10")
```

# Excercise 2

## 2.1

Pick two quantitative variables to explore.

Make a summary table of descriptive statistics for these variables using summarize().
Include whatever staistics you feel appropriate (mean, median sd, range, etc.).
Make a scatterplot of these variables using ggplot().


```{r}
library(palmerpenguins)
palmerpenguins::penguins %>% 
  summarize(across(c(body_mass_g, flipper_length_mm),
  list(mean = ~ mean(.x, na.rm = TRUE), 
       sd = ~ sd(.x, na.rm = TRUE),
       min = ~ min(.x, na.rm = TRUE),
       max = ~ max(.x, na.rm = TRUE)))) 

palmerpenguins::penguins %>% 
  ggplot() +
  aes(x = body_mass_g, y = flipper_length_mm) +
  geom_jitter() +
  geom_point(fill = "white", color = "red", alpha = .5,  size = 3)
```

## 2.2

Pick one categorical variable and one quantitative variable to explore.

Make a summary table giving the sample size (hint: n()) and descriptive statistics for the quantitative variable by group.
Make one or more useful plots to visualize these variables.


```{r}
palmerpenguins::penguins %>% 
  group_by(species) %>% 
  summarize( 
    total_penguins = n(),
    average_body_mass = mean(body_mass_g, na.rm = TRUE),
    sd_of_body_mass = sd(body_mass_g, na.rm = TRUE),
    average_flipper_length = mean(flipper_length_mm, na.rm = TRUE),
    sd_of_flipper_length = sd(flipper_length_mm, na.rm = TRUE))
```



```{r}
palmerpenguins::penguins %>% 
  ggplot() +
  geom_jitter(height = 1.5, 
              alpha = .5,
              size = 1.0) +
  aes(x = species, y = body_mass_g) +
  geom_point(fill = "black", color = "red", alpha = .5, size = 3)

palmerpenguins::penguins %>% 
  ggplot() +
  aes(body_mass_g) + 
  geom_histogram()
```